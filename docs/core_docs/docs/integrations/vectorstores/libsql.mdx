# libSQL

[Turso](https://turso.tech) is a SQLite-compatible database built on [libSQL](https://docs.turso.tech/libsql), the Open Contribution fork of SQLite.

Vector Similiarity Search is built into Turso and libSQL Server as a native datatype. This enables you to store and query vectors directly in the database.

## Setup

You can use local SQLite when working with the libSQL vector store, or use a hosted Turso Database.

### 1. Create a Database

#### Option 1. Local development with a SQLite file

```bash
sqlite3 file.db
```

Inside the shell, create a new table or add the embedding column to an existing table.

Follow the instructions below in step 2.

### Option 2. Create a Turso Database

Visit [sqlite.new](https://sqlite.new) to create a new database, give it a name, and create a database auth token.

Make sure to copy the database auth token, and the database URL, it should look something like:

```text
libsql://[database-name]-[your-username].turso.io
```

### 2. Add a vector field to a new or existing table

Execute the following SQL command to create a new table or add the embedding column to an existing table.

Make sure to mopdify the following parts of the SQL:

- `TABLE_NAME` is the name of the table you want to create.
- `content` is used to store the `Document.pageContent` values.
- `metadata` is used to store the `Document.metadata` object.
- `EMBEDDING_COLUMN` is used to store the vector values, use the dimensions size used by the model you plan to use (1536 for OpenAI).

```sql
CREATE TABLE IF NOT EXISTS TABLE_NAME (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    content TEXT,
    metadata TEXT,
    EMBEDDING_COLUMN FLOAT32(1536) -- 1536-dimensional f32 vector for OpenAI
);
```

### 3. Create a new index

Make sure to replace the `TABLE_NAME` and `EMBEDDING_COLUMN` with the values you used in the previous step.

```sql
CREATE INDEX IF NOT EXISTS TABLE_NAME_idx ON TABLE_NAME (libsql_vector_idx(EMBEDDING_COLUMN));
```

## Application code

To work with Turso and libSQL, you must install the `@libsql/client` package:

```bash npm2yarn
npm install @libsql/client
```

import IntegrationInstallTooltip from "@mdx_components/integration_install_tooltip.mdx";

<IntegrationInstallTooltip></IntegrationInstallTooltip>

To initialize a new `LibSQL` vector store, you need to provide the database URL and Auth Token:

```typescript
import { createClient } from "@libsql/client";

const client = createClient({
  url: "libsql://[database-name]-[your-username].turso.io",
  authToken: "...",
});

const vectorStore = new LibSQLVectorStore(client, {
  tableName: "TABLE_NAME",
  embeddingColumn: "EMBEDDING_COLUMN",
  dimensions: 153,
});
```

When working locally, you can use a sqlite file and omit the `authToken`:

```typescript
const client = createClient({
  url: "file:./dev.db",
});
```

```bash npm2yarn
npm install @langchain/openai @langchain/community
```

## Usage

import CodeBlock from "@theme/CodeBlock";
import Example from "@examples/indexes/vector_stores/libsql/example.ts";

<CodeBlock language="typescript">{Example}</CodeBlock>

## Related

- Vector store [conceptual guide](/docs/concepts/#vectorstores)
- Vector store [how-to guides](/docs/how_to/#vectorstores)
